# 分析页面撤回功能说明

## 功能概述

在音频分析页面（http://localhost:8082/analysis）中，现在支持使用 `Ctrl+Z` 快捷键撤回上一次的标签操作。

## 支持撤回的操作

1. **添加节拍点**
   - 双击波形图添加
   - 按 W/A/S/D 键添加

2. **移动节拍点**
   - 拖拽节拍点
   - 使用左右箭头键移动选中的节拍点

3. **删除节拍点**
   - 右键菜单中选择删除

## 使用方法

1. 在分析页面进行任何添加、移动或删除节拍点的操作
2. 如需撤回最后一次操作，按下 `Ctrl+Z`
3. 系统会弹出确认对话框，显示即将撤回的操作详情
4. 点击"确认"按钮执行撤回，点击"取消"按钮放弃撤回

## 操作示例

### 撤回添加操作
- 执行：双击波形图添加节拍点
- 撤回：按 `Ctrl+Z`，确认后节拍点被删除

### 撤回移动操作
- 执行：拖拽节拍点从 1.23s 移到 1.45s
- 撤回：按 `Ctrl+Z`，确认后节拍点恢复到 1.23s

### 撤回删除操作
- 执行：右键删除节拍点（原位置 2.34s）
- 撤回：按 `Ctrl+Z`，确认后节拍点在 2.34s 处重新出现

## 注意事项

1. 最多保存最近 50 条操作历史
2. 键盘箭头键连续移动时，只在释放按键时记录一次操作，避免历史记录过多
3. 撤回操作需要确认才会执行，避免误操作
4. 撤回后的操作会从历史记录中移除，无法再次撤回
5. 保存节拍修改后，建议重新操作前先测试确认数据正确

## 技术实现

- 使用操作历史栈记录每次操作
- 每次操作保存操作类型、region ID 和相关数据
- 撤回时根据操作类型执行相应的反向操作
- 使用 Element Plus 的 MessageBox 组件提供确认对话框









